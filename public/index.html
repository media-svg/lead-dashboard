<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Lead Response Board</title>

  <style>
    body {
      background-color: #0f172a;
      color: white;
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 40px;
    }

    h1 {
      font-size: 60px;
      margin-bottom: 20px;
    }

    .count {
      font-size: 120px;
      margin-bottom: 40px;
    }

    .lead {
      width: 60%;
      margin: 20px auto;
      padding: 25px;
      border-radius: 12px;
      font-size: 36px;
      font-weight: bold;
    }

    .green { background-color: #15803d; }
    .yellow { background-color: #ca8a04; }
    .red { background-color: #b91c1c; }

  </style>
</head>

<body>

  <h1>LEADS WAITING</h1>
  <div class="count" id="count">0</div>

  <div id="leadList"></div>

  <script>
    async function fetchLeads() {
      const response = await fetch('/leads');
      const leads = await response.json();

      document.getElementById("count").innerText = leads.length;

      const list = document.getElementById("leadList");
      list.innerHTML = "";

      leads.forEach(lead => {
        const minutes = Math.floor((Date.now() - lead.created_at) / 60000);

        let color = "green";
        if (minutes >= 5) color = "yellow";
        if (minutes >= 10) color = "red";

        const div = document.createElement("div");
        div.className = "lead " + color;
        div.innerHTML = lead.name + " â€” " + minutes + " min";

        list.appendChild(div);
      });
    }

    setInterval(fetchLeads, 5000);
    fetchLeads();
  </script>

</body>
</html>
